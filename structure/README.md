### Generate the pdb structure file for AA and AT configurations

Original pdb file is from pdb ID 6qnr. 

Modifications of pdb file: 
  1. Remove L10 from the file because of missing residues 
  2. Remove the first residue U in file 6qnr-pdb-bundle1.pdb because of the missing residues between residue 1U and the next residue in the file 

Combine the modified `6qnr-pdb-bundle1.pdb` and `6qnr-pdb-bundle2.pdb` file to generate a pdb file for the full ribosome structure (corresponding to bioassmbly 1 in PDB webpage) >>> 	`6qnr-bioassembly1-phe.adjusted.box.mod.noL10.nofirstU.pdb`

AT configuration structure file was generated by aligning the A-site tRNA to the AT configuration from pdb 4V5G (see alignment instruction)  >>> `6qnr-AT.noL10.nofirstU.pdb`

### Construct topology file using standard SMOG model
    
- Construct topology file from AA configuration using smog2
``` 
smog2 -i 6qnr-bioassembly1-phe.adjusted.box.mod.noL10.nofirstU.pdb -t /your/smog/template -dname 6qnr-AA.noL10.nofirstU
```
*The topology file from AA configuration will be used for setting up the simulation*

- Construct topology file from AT configuration using smog2
```
smog2 -i 6qnr-AT.noL10.nofirstU.pdb -t /your/smog/template -dname 6qnr-AT.noL10.nofirstU
```
*The topology file of AT configuration will be used for comparing contacts associated with A-site tRNA and determining the unique contacts for AA configuration*

### Condense the topology file

The topology file can be separated into small .itp files. The topology file of full ribosome is quite large. Separated the topology file into small .itp files makes it easier to modify the topology file (such as removing some contacts) and version control.

The topology file of AA configuration is separated into 5 small .itp files:
- `top1_atoms.6qnr_AA.std_smog.itp`
- `top2_bonds.6qnr_AA.std_smog.itp`
- `top3_angles_dihedrals.6qnr_AA.std_smog.itp`
- `top4_pairs.6qnr_AA.std_smog.itp`
- `top5_exclusions.6qnr_AA.std_smog.itp`

The condensed .top file (`6qnr-AA.noL10.nofirstU.condense.top`) only needs to include the above small .itp files. 

### Adjust the topology file

1. Reduce the contacts that are unique to A-site tRNA in AA configuration by a factor of 0.4
    1. What are the unique contacts of A-site tRNA in AA configuration?
        For a contact that associates with A-site tRNA, if the distance between the two atoms that form this contact in the AA configuration is less than a half of the distance between the same two atoms in the AT configuration, then this contact is a unique contact to AA configuration. There are 354 unique contacts of A-site tRNA in AA configuration.
        
2. Remove the contacts between A-tRNA-arm-CCA-PHE region and the rest part of the ribosome (the parts except A-site tRNA)
This step can be achived by `smog_scale-energies` or a self-constructed script. If you are doing it using your own script, don't forget to make the corresponding changes in the [ exclusions ] section.

3. Remove the harmonic bonds between A-site tRNA (CCA end) and the chelated Mg2+ or K+

*After the above adjustments, please double check the file names of the .itp file in the condensed topology file to ensure the correct version of .itp files is used for the simulation.*

### Groups mentioned in .ndx file

- A-elbow: res 14A to 21A and res 47U to 64A on A site tRNA (serial 52021 to 52193 and serial 52742 to 53118)
- P-elbow: res 14A to 21A and res 47U to 64A on A site tRNA (serial 53659 to 53831 and 54380 to 54763)
- A-CCA: res 74C to 76 A of A site tRNA (serial 53313 to 53374)
- P-CCA: res 74 to 76 of P site tRNA (serial 54958 to 55019)
- notAtRNA: not A site tRNA (not serial 51748 to 53385)
- A-A76-O3: O3* of residue 76A on A site tRNA (serial 53361)
- P-A76-O3: O3* of residue 76A on P site tRNA (serial 55006)
- A-U47: O3* of 47U of A site tRNA (serial 52750)
- P-U8: O3* of 8U of P site tRNA (serial 53547)
- A-U60: O3* of res 60U of A site tRNA (serial 53022)
- P-G67-C5: C5* of res 67G of P site tRNA (serial 54811)
- A-G4-C3: C3* of res 4G of A site tRNA (serial 51815)
- A-tRNA-arm-CCA-PHE: serial 51748 to 51895 and serial 53119-53385
- L14_full: res 8813 to 8934


